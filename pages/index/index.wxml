<!--index.wxml-->
<view class="container-bg">
  <custom-nav title="麦小律"></custom-nav>
  <image class="container-bg-image" src="/static/images/index/container-bg@2x.png" mode="widthFix" />
  <view class="container">
    <!-- 固定不动的顶部区域 -->
    <view class="fixed-top">
      <view class="banner">
        <view class="banner-text">
          <view class="title">您好，我是小麦</view>
          <view class="subtitle">您的全天候智能法律顾问，随时为您解答法律问题~</view>
        </view>
        <image class="robot-avatar" src="/static/images/index/robot@2x.png" mode="widthFix" />      
      </view>
    </view>
    
    <!-- 可滚动的聊天区域 -->
    <view class="chat-area {{isKeyboardShow ? 'keyboard-show' : ''}}">
      <image class="chat-bg" src="/static/images/index/chat-content-bg.png" mode="widthFix" />
      <view class="chat-container">
        <scroll-view 
          id="scrollView"
          class="chat-content"
          scroll-y="true"
          enhanced="true"
          show-scrollbar="false"
          scroll-anchoring="true"
          scroll-into-view="{{scrollToView}}"
          scroll-with-animation="{{true}}"
          style="height: calc(100vh - {{isKeyboardShow ? (keyboardHeight + 360) : 460}}rpx);"
        >
          <!-- 保留原有的指导提示 -->
          <view class="guide-title">您可以这样问我：</view>
          <view class="guide-list">
            <view class="guide-item" wx:for="{{suggestions}}" wx:key="*this" bindtap="handleTapSuggestion" data-text="{{item}}">
              <view class="guide-message">{{item}}</view>
            </view>
          </view>

          <!-- 添加聊天消息列表 -->
          <view class="message-list">
            <block wx:for="{{messageList}}" wx:key="id">
              <view id="msg{{item.id}}" class="message-item {{item.type === 'user' ? 'user-message' : 'ai-message'}}">
                <text class="message-time">{{item.time}}</text>
                <view class="message-content">{{item.content}}</view>
              </view>
            </block>
          </view>
        </scroll-view>

        <view class="input-area" style="{{inputStyle}}">
          <view class="input-box">
            <input 
              class="chat-input" 
              value="{{inputValue}}"
              placeholder="请输入想要问的问题" 
              placeholder-class="input-placeholder"
              adjust-position="{{false}}"
              cursor-spacing="20"
              bindfocus="onInputFocus"
              bindblur="onInputBlur"
              bindinput="onInput"
              bindconfirm="sendMessage"
            />
          </view>
          <button class="send-btn" bindtap="sendMessage">
            <image class="send-icon" src="/static/images/index/send@2x.png" mode="widthFix" />
          </button>
        </view>
      </view>
    </view>
  </view>
</view>
