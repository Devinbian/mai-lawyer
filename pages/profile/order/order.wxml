<view class="container">
  <bg-titlecenter-nav title="我的订单"></bg-titlecenter-nav>

  <!-- 订单状态标签 -->
  <view class="order-tabs">
    <view class="tab-item {{currentTab === 'all' ? 'active' : ''}}" bindtap="switchTab" data-type="all">全部</view>
    <view class="tab-item {{currentTab === 'pending' ? 'active' : ''}}" bindtap="switchTab" data-type="pending">待支付</view>
    <view class="tab-item {{currentTab === 'paid' ? 'active' : ''}}" bindtap="switchTab" data-type="paid">已支付</view>
    <view class="tab-item {{currentTab === 'refunded' ? 'active' : ''}}" bindtap="switchTab" data-type="refunded">已退款</view>
  </view>

  <!-- 订单列表 -->
  <scroll-view class="order-list" scroll-y>
    <view class="order-item" wx:for="{{orderList}}" wx:key="orderId">
      <!-- 订单类型 -->
      <view class="order-type">
        <image class="type-icon" src="{{item.type === 'phone' ? imgUrls.orderphone : imgUrls.ordertext}}" mode="aspectFit"></image>
        <text class="order-type-text">{{item.typeName}}</text>
        <text class="order-status {{item.status === 'pending' ? 'pending' : item.status === 'paid' ? 'paid' : 'refunded'}}">{{item.statusText}}</text>
      </view>

      <!-- 订单信息 -->
      <view class="order-info">
        <view class="info-item">
          <text class="label">咨询时间：</text>
          <text class="value">{{item.consultTime}}</text>
        </view>
        <view class="info-item">
          <text class="label">订单编号：</text>
          <text class="value">{{item.orderId}}</text>
        </view>
        <view class="info-item">
          <text class="label">订单价格：</text>
          <text class="value price">¥ {{item.price}}</text>
        </view>
        <view class="info-item">
          <text class="label">服务律师：</text>
          <text class="value">{{item.lawyer}}</text>
        </view>
      </view>

      <!-- 订单操作 -->
      <view class="order-actions">
        <view class="more" bindtap="showMore" data-id="{{item.orderId}}">更多</view>
        <block wx:if="{{item.status === 'pending'}}">
          <view class="action-btn cancel" bindtap="cancelOrder" data-id="{{item.orderId}}">取消订单</view>
          <view class="action-btn pay" bindtap="payOrder" data-id="{{item.orderId}}">去支付</view>
        </block>
        <block wx:elif="{{item.status === 'paid'}}">
          <view class="action-btn refund" bindtap="applyRefund" data-id="{{item.orderId}}">申请退款</view>
        </block>
        <block wx:elif="{{item.status === 'refunded'}}">
          <view class="action-btn refund-detail" bindtap="showRefundDetail" data-id="{{item.orderId}}">售后详情</view>
          <view class="action-btn delete" bindtap="deleteOrder" data-id="{{item.orderId}}">删除订单</view>
        </block>
      </view>
    </view>

    <!-- 空状态 -->
    <view class="empty-state" wx:if="{{orderList.length === 0}}">
      <image src="{{imgUrls.noorder}}" mode="aspectFit"></image>
      <text>暂无订单</text>
    </view>
  </scroll-view>
</view> 